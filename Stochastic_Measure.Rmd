---
title: "Stochastic Measure"
author: "Henry Traynor"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

How stochastic is our model?
We want to create a set of realizations with a single set of parameters and examine the differences in system behavior.

First, we create a roost map.

```{r}
set.seed(314159)

SIR_parms  <- c(beta = 0.1, #transmission rate
                gamma = 0.03) # recovery rate

roost_parms <- c(num_roosts = 10,  # number of roosts
                 num_clusters = 3, # number of clusters
                 sd = 0.1)           # standard distance from cluster center

source("Functions/roost_map.R")
source("Functions/single_day.R")

roost_map <- roostMap(roost_parms)
roost_dist <- distMatrix(roost_parms[1], roost_map)

library(ggplot2)
ggplot(roost_map, aes(x,y, color=bin, label = lbl, size=N_max)) + geom_text() + xlim(0,1) + ylim(0,1)
```

```{r}
roosts <- data.frame(
  S = vector("numeric", length=roost_parms[1]),
  I = vector("numeric", length=roost_parms[1]),
  R = vector("numeric", length=roost_parms[1]),
  N = vector("numeric", length=roost_parms[1]),
  N_max = roost_map$N_max
)

#Populate Roosts
roosts$N <- round(roosts$N_max/1.5)
roosts$S <- roosts$N-1
roosts$I <- roosts$N-roosts$S

#Total distances between any 2 roosts
total_dist <- 0
for(i in 1:roost_parms[1]) {
  for(j in 1:i) {
    total_dist <- total_dist + as.numeric(roost_dist[i,j])
  }
}

#Score, a measure of isolation. greater score ==> greater isolation
scores <- vector("numeric", length=roost_parms[1])
for(i in 1:roost_parms[1]) {
  tot <- sum(roost_dist[i,])
  scores[i] <- tot/total_dist
}
```

Next, we create a set of realizations and record values for a single roost.

```{r}
roost_series_series <- list()

for(i in 1:10) {
  roost_series <- list()
  for(j in 2:500) {
    roost_series[[j]] = singleDay(roost_series[[j-1]], roost_dist, roost_parms, SIR_parms, num_roosts = roost_parms[1], phi_max=0.2)
  }
  roost_series_series[[i]] <- roost_series
}

```

